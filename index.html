<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>머니블랙박스 (MONEY BLACKBOX)</title>
    
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css">
    <link rel="stylesheet" href="https://hangeul.pstatic.net/hangeul_static/css/nanum-barun-gothic.css">
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://unpkg.com/react@18/umd/react.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js" crossorigin></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: { primary: '#0066FF' },
                    fontFamily: { sans: ['Pretendard', 'Nanum Barun Gothic', 'sans-serif'] }
                }
            }
        }
    </script>
    <style>
        body { font-family: 'Pretendard', 'Nanum Barun Gothic', sans-serif; background-color: #f3f4f6; }
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;
        const { motion, AnimatePresence, useInView } = window.Motion || window.FramerMotion;
        const supabaseUrl = 'https://iiuxqifppjuwracdewrn.supabase.co';
        const supabaseAnonKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlpdXhxaWZwcGp1d3JhY2Rld3JuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjY1Njk0MTQsImV4cCI6MjA4MjE0NTQxNH0.d53vLqEcBhgsSU19EhkM8D1cs2_ne6UpYQ-xbnU4Zvw';
        const supabaseClient = window.supabase.createClient(supabaseUrl, supabaseAnonKey);

        const App = () => {
            const [regCount, setRegCount] = useState(0);
            const [displayCount, setDisplayCount] = useState(0);
            const [phoneNumber, setPhoneNumber] = useState('');
            const [email, setEmail] = useState('');
            const [requiredAgreed, setRequiredAgreed] = useState(false);
            const [marketingAgreed, setMarketingAgreed] = useState(false);
            const [activeModal, setActiveModal] = useState(null);
            const [isSubmitting, setIsSubmitting] = useState(false);

            const countRef = useRef(null);
            const isCountInView = useInView(countRef, { once: true, margin: "-20% 0px" });

            useEffect(() => {
                const targetCount = 239;
                setRegCount(targetCount);
                setDisplayCount(targetCount - 50);
            }, []);

            useEffect(() => { if (window.lucide) window.lucide.createIcons(); });

            useEffect(() => {
                if (isCountInView && regCount > 0) {
                    const duration = 1000;
                    const startCount = regCount - 50;
                    const startTime = performance.now();
                    const animate = (currentTime) => {
                        const elapsedTime = currentTime - startTime;
                        const progress = Math.min(elapsedTime / duration, 1);
                        const easeOutQuad = (t) => t * (2 - t);
                        const currentNumber = Math.floor(startCount + (regCount - startCount) * easeOutQuad(progress));
                        setDisplayCount(currentNumber);
                        if (progress < 1) requestAnimationFrame(animate);
                        else setDisplayCount(regCount);
                    };
                    requestAnimationFrame(animate);
                }
            }, [isCountInView, regCount]);

            const handleSubmit = async (e) => {
                e.preventDefault();
                if (!requiredAgreed || !marketingAgreed) return alert('필수 동의 항목에 모두 동의해주세요.');
                setIsSubmitting(true);
                try {
                    const { error } = await supabaseClient.from('pre_registrations').insert([{ 
                        phone_number: phoneNumber, email: email, agreed_to_terms: requiredAgreed, marketing_agreed: marketingAgreed
                    }]);
                    if (error) throw error;
                    alert('🎉 사전등록이 완료되었습니다!');
                    setPhoneNumber(''); setEmail(''); setRequiredAgreed(false); setMarketingAgreed(false);
                } catch (error) {
                    alert('⚠️ 오류 발생: ' + (error.message || JSON.stringify(error)));
                } finally { setIsSubmitting(false); }
            };

            const Modal = ({ type, onClose }) => {
                const content = type === 'privacy' ? {
                    title: '개인정보 처리방침',
                    text: `1. 개인정보 수집 및 이용 목적\n- 서비스 출시 알림 제공\n- 잠재 고객 수요 조사 및 분석\n- 서비스 초기 프로모션 혜택 제공\n\n2. 수집하는 개인정보 항목\n- 필수항목: 휴대전화번호, 이메일 주소\n\n3. 개인정보 보유 및 이용 기간\n- 이용 기간: 사전 신청 시점부터 서비스 정식 출시 후 3개월까지\n- 파기 시점: 보유 기간 경과 또는 이용 목적 달성 시 지체 없이 파기\n(단, 관계 법령에 따라 보존할 필요가 있는 경우 해당 기간 동안 보관)\n\n4. 동의 거부 권리 및 불이익\n- 귀하는 개인정보 수집 및 이용에 대한 동의를 거부할 권리가 있습니다.\n- 단, 동의를 거부할 경우 사전 신청 등록 및 출시 알림 서비스 이용이 제한될 수 있습니다.`
                } : {
                    title: '마케팅 정보 수신 동의',
                    text: `1. 개인정보 수집 및 이용 목적\n- 서비스 정식 런칭 소식 안내 (SMS/이메일)\n- 새로운 기능, 이벤트, 프로모션 혜택 등 광고성 정보 전송\n\n2. 수집 및 이용하는 개인정보 항목\n- 휴대전화번호, 이메일 주소\n\n3. 보유 및 이용 기간\n- 이용 기간: 수집일로부터 1년 또는 동의 철회 시까지\n- 고객이 동의를 철회하는 경우 지체 없이 파기합니다.\n\n4. 동의 거부 권리 및 유의사항\n- 귀하는 마케팅 정보 수신에 대한 동의를 거부할 수 있습니다.\n- 동의를 거부하더라도 사전 신청 자체는 가능하나, 출시 알림이나 혜택 정보를 받지 못할 수 있습니다.`
                };
                return (
                    <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }} className="fixed inset-0 z-50 flex items-center justify-center p-6 bg-black/40 backdrop-blur-sm" onClick={onClose}>
                        <motion.div initial={{ scale: 0.9, opacity: 0, y: 20 }} animate={{ scale: 1, opacity: 1 }} className="bg-white w-full max-w-sm rounded-3xl overflow-hidden shadow-2xl flex flex-col max-h-[80vh]" onClick={e => e.stopPropagation()}>
                            <div className="p-6 border-b flex justify-between items-center"><h4 className="font-bold">{content.title}</h4><button onClick={onClose} className="p-2 hover:bg-gray-100 rounded-full transition-colors"><i data-lucide="x" className="w-5 h-5 text-gray-400"></i></button></div>
                            <div className="p-6 overflow-y-auto whitespace-pre-wrap text-sm text-gray-600 leading-relaxed">{content.text}</div>
                            <div className="p-4 bg-gray-50"><button onClick={onClose} className="w-full py-3 bg-gray-900 text-white font-bold rounded-xl">닫기</button></div>
                        </motion.div>
                    </motion.div>
                );
            };

            return (
                <div className="flex justify-center min-h-screen bg-gray-100">
                    <main className="w-full max-w-md bg-white shadow-xl min-h-screen overflow-x-hidden relative">
                        <AnimatePresence>{activeModal && <Modal type={activeModal} onClose={() => setActiveModal(null)} />}</AnimatePresence>

                        {/* Phase 1: Logo Section (Black) */}
                        <section className="h-screen bg-black flex items-center justify-center">
                            <h2 className="text-5xl font-black tracking-tighter text-center leading-[1.4] uppercase text-white">Money<br/>Blackbox</h2>
                        </section>

                        {/* Phase 2: Hero Section (White) */}
                        <section className="bg-white py-24 flex flex-col items-center">
                            <div className="w-full px-12 mb-20 flex flex-col items-start text-black text-black">
                                <p className="font-medium mb-2 text-xl">쉽고 간편하게</p>
                                <div className="text-4xl font-extrabold leading-[1.3] tracking-tight text-black">
                                    <p>의심은 덜고</p><p>신뢰는 더하는</p><p className="text-primary">안심결제</p>
                                </div>
                            </div>
                            <div className="relative w-full px-4 flex items-center justify-center">
                                <div className="relative z-10 w-full max-w-[300px]"><img src="hero.png" alt="Hero" className="w-full h-auto object-contain" /></div>
                            </div>
                        </section>

                        <div className="bg-white">
                            <section className="pt-20 pb-40 px-6 space-y-12">
                                {[
                                    { text: '"불안해서 먼저 입금을 못 하겠어요"', tail: 'left' },
                                    { text: '"상대방이 돈을 안 주면 어떡하죠?"', tail: 'right' },
                                    { text: '"혹시 사기는 아닐까?"', tail: 'both' }
                                ].map((b, i) => (
                                    <motion.div key={i} initial={{ opacity: 0, x: i % 2 === 0 ? -30 : 30 }} whileInView={{ opacity: 1, x: 0 }} transition={{ duration: 1.2, delay: i * 0.3 }} viewport={{ once: true }} className="flex justify-center">
                                        <div className="relative bg-[#E0E0E0] px-8 py-4 rounded-[2rem] w-full max-w-[320px] text-center shadow-sm">
                                            <p className="text-[15px] font-medium leading-relaxed text-black">{b.text}</p>
                                            {(b.tail === 'left' || b.tail === 'both') && <div className="absolute left-[-8px] bottom-4 w-6 h-6 bg-[#E0E0E0]" style={{ clipPath: 'polygon(100% 0, 0 100%, 100% 100%)' }}></div>}
                                            {(b.tail === 'right' || b.tail === 'both') && <div className="absolute right-[-8px] bottom-4 w-6 h-6 bg-[#E0E0E0]" style={{ clipPath: 'polygon(0 0, 0 100%, 100% 100%)' }}></div>}
                                        </div>
                                    </motion.div>
                                ))}
                                <div className="pt-40 space-y-12 text-black">
                                    <motion.div initial={{ opacity: 0, x: -50 }} whileInView={{ opacity: 1, x: 0 }} transition={{ duration: 1.5 }} viewport={{ once: true }} className="text-left px-4 font-bold text-xl leading-relaxed">작은 의심 때문에<br/>우리는 너무 많은 기회를<br/>포기해왔습니다</motion.div>
                                    <motion.div initial={{ opacity: 0, x: 50 }} whileInView={{ opacity: 1, x: 0 }} transition={{ duration: 1.5, delay: 0.4 }} viewport={{ once: true }} className="text-right px-4 font-bold text-xl leading-relaxed text-black">우리는 의심이<br/>좋은 기회를 가로막는 장벽이<br/>되지 않기를 바랍니다</motion.div>
                                </div>
                            </section>

                            <section className="bg-black py-28 px-8">
                                <h2 className="text-white text-2xl font-bold leading-[1.6] uppercase">Money Blackbox<br/>에서 의심을 지우고<br/><span className="text-primary">신뢰</span>로 기회를 잡으세요</h2>
                            </section>

                            <section className="py-20 px-8 relative overflow-hidden">
                                <div className="mb-20">
                                    <h3 className="text-2xl font-bold text-black uppercase leading-tight">신뢰를 만드는<br/>머니블랙박스 거래 프로세스</h3>
                                    <p className="text-sm text-primary mt-2 font-medium"><span className="text-black">구매자와 판매자</span> 모두가 보호받는 시스템</p>
                                </div>
                                <div className="relative">
                                    {/* Vertical Line - Adjusted to stop at Step 4 Icon */}
                                    <div className="absolute left-[27px] top-7 bottom-[130px] w-[2px] bg-[#0066FF] opacity-30 z-0"></div>
                                    <div className="space-y-16 relative z-10 text-black">
                                        {[
                                            { icon: 'wallet', title: 'STEP 01. 대금 안전 보관', desc: '구매자는 머니블랙박스에\n거래 금액을 보관해요', sub: '판매자에게 직접 입금하지 않고 시스템에 예치하여\n거래 사기를 근본적으로 차단합니다.' },
                                            { icon: 'user-check', title: 'STEP 02. 입금 확인 및 발송', desc: '판매자는 입금 여부를 확인하고\n거래를 진행해요', sub: '머니블랙박스에서 입금 완료 알림을 확인한 후,\n판매자는 안심하고 물건 발송이나 서비스를 제공합니다.', banner: '시스템이 24시간 입금 상태를 모니터링 중입니다.' },
                                            { isThumbs: true, title: 'STEP 03. 상호 성사 동의', desc: '구매자와 판매자는\n거래 성사 여부에 동의해요', sub: '거래가 원만히 완료되었음을 양측이 확인하면,\n머니블랙박스는 최종 정산 단계를 준비합니다.' },
                                            { isWon: true, title: 'STEP 04. 꼼꼼한 확인과 정산', desc: '성사 여부를 꼼꼼히 확인하고\n정산이 이루어져요', sub: '머니블랙박스가 최종적으로 이상 유무를 검토한 뒤,\n판매자에게 안전하게 대금을 정산합니다.' }
                                        ].map((s, i) => (
                                            <motion.div key={i} initial={{ opacity: 0, y: 30 }} whileInView={{ opacity: 1, y: 0 }} transition={{ duration: 1.2, delay: i * 0.2 }} viewport={{ once: true, margin: "-10% 0px" }} className="flex gap-6">
                                                <div className="flex-shrink-0 w-14 h-14 bg-white border-2 border-[#0066FF] rounded-2xl flex items-center justify-center shadow-sm">
                                                    {s.isWon ? <span className="text-2xl font-black text-[#0066FF]">₩</span> : s.isThumbs ? <i data-lucide="thumbs-up" className="w-7 h-7 text-[#0066FF]"></i> : <i data-lucide={s.icon} className="w-7 h-7 text-[#0066FF]"></i>}
                                                </div>
                                                <div className="flex flex-col pt-1">
                                                    <span className="text-[11px] font-bold text-[#0066FF] mb-2 uppercase">{s.title}</span>
                                                    <h4 className="text-[17px] font-bold mb-3 leading-tight whitespace-pre-wrap">{s.desc}</h4>
                                                    <p className="text-[13px] text-gray-500 leading-relaxed mb-4 whitespace-pre-wrap">{s.sub}</p>
                                                    {s.banner && <div className="bg-[#F0F7FF] py-2 px-4 rounded-lg flex items-center gap-2 w-fit"><i data-lucide="shield-check" className="w-4 h-4 text-[#0066FF]"></i><span className="text-[11px] font-bold text-[#0066FF]">{s.banner}</span></div>}
                                                </div>
                                            </motion.div>
                                        ))}
                                    </div>
                                </div>
                                <motion.div initial={{ opacity: 0, y: 30 }} whileInView={{ opacity: 1, y: 0 }} transition={{ duration: 1.5, delay: 0.8 }} viewport={{ once: true, margin: "-10% 0px" }} className="mt-16 text-black">
                                    <p className="text-sm leading-relaxed text-black">거래 과정에서 문제가 발생하면 합의가 이루어질 때까지<br/>여러분의 소중한 재산은 머니블랙박스가 <span className="text-primary font-bold">안전하게 보호합니다</span></p>
                                </motion.div>
                            </section>

                            <section className="pt-40 pb-20 px-8 text-black">
                                <h3 className="text-2xl font-bold mb-12 text-black">머니블랙박스가 특별한<br/>3가지 이유</h3>
                                <div className="space-y-12">
                                    {[{ h: '1. 모든 거래에 적용이 가능합니다', p: '중고거래부터 - 공사비용까지' }, { h: '2. 안전한 거래를 최우선으로 지향합니다', p: '수상한 거래 감지시, 먼저 거래 중단, 차단!\n소중한 재산을 안전하게 보관' }, { h: '3. 제약이 없습니다', p: '인스타, 카페, 블로그 어디에서 본 상품을\n결제는 수수료 ZERO 머니 블랙박스 결제 링크로!' }].map((f, i) => (
                                        <div key={i}><h4 className="text-lg font-bold text-primary mb-3 text-black">{f.h}</h4><p className="text-base whitespace-pre-wrap leading-relaxed">{f.p}</p></div>
                                    ))}
                                </div>
                            </section>

                            <section className="pt-40 pb-40 text-center px-8 text-black">
                                <h3 className="text-2xl font-bold leading-[1.6]">머니블랙박스를 통해<br/>거래의 <span className="text-primary">신뢰</span>를 확보하세요</h3>
                            </section>

                            <section className="py-20 px-8 border-t border-gray-100 text-black">
                                <div className="text-center mb-10 text-black text-black"><p className="text-sm font-bold text-gray-600 mb-2">지금 사전등록하면 (선착순 300명)</p><h2 className="text-2xl font-bold">평생 안심결제 수수료 <span className="text-primary text-3xl">0원</span></h2></div>
                                <div className="mb-12" ref={countRef}><p className="text-xs font-bold mb-4 text-center">사전등록 현황</p><div className="flex justify-center items-end gap-2"><span className="text-5xl font-black text-primary">{displayCount}</span><span className="text-2xl font-bold text-gray-400">/ 300</span></div></div>
                                <form onSubmit={handleSubmit} className="space-y-6">
                                    <div className="space-y-1"><label className="text-xs font-bold">전화번호</label><input type="tel" placeholder="010-0000-0000" className="w-full bg-gray-100 rounded-xl px-4 py-4 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20" value={phoneNumber} onChange={e => setPhoneNumber(e.target.value)} required /></div>
                                    <div className="space-y-1"><label className="text-xs font-bold">이메일</label><input type="email" placeholder="example@email.com" className="w-full bg-gray-100 rounded-xl px-4 py-4 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20" value={email} onChange={e => setEmail(e.target.value)} required /></div>
                                    <div className="py-4 space-y-4">
                                        <div className="flex items-center justify-between"><label className="flex items-center gap-2 cursor-pointer"><input type="checkbox" className="hidden" checked={requiredAgreed} onChange={() => setRequiredAgreed(!requiredAgreed)} /><div className={`w-5 h-5 rounded border ${requiredAgreed ? 'bg-primary border-primary' : 'border-gray-300'} flex items-center justify-center transition-colors`}>{requiredAgreed && <i data-lucide="check" className="text-white w-3 h-3"></i>}</div><span className="text-xs font-medium text-gray-600">[필수] 개인정보 수집 및 이용에 동의합니다.</span></label><button type="button" onClick={() => setActiveModal('privacy')} className="text-[10px] text-gray-400 underline">(전문 보기)</button></div>
                                        <div className="flex items-center justify-between"><label className="flex items-center gap-2 cursor-pointer"><input type="checkbox" className="hidden" checked={marketingAgreed} onChange={() => setMarketingAgreed(!marketingAgreed)} /><div className={`w-5 h-5 rounded border ${marketingAgreed ? 'bg-primary border-primary' : 'border-gray-300'} flex items-center justify-center transition-colors`}>{marketingAgreed && <i data-lucide="check" className="text-white w-3 h-3"></i>}</div><span className="text-xs font-medium text-gray-600">[필수] 서비스 출시 알림 및 이벤트 정보 수신에 동의합니다.</span></label><button type="button" onClick={() => setActiveModal('marketing')} className="text-[10px] text-gray-400 underline">(전문 보기)</button></div>
                                    </div>
                                    <button type="submit" disabled={isSubmitting || !requiredAgreed || !marketingAgreed} className={`w-full bg-primary text-white font-bold py-5 rounded-2xl shadow-lg active:scale-[0.98] transition-all ${isSubmitting || !requiredAgreed || !marketingAgreed ? 'opacity-50 cursor-not-allowed grayscale' : ''}`}>{isSubmitting ? '등록 중...' : '사전등록하기'}</button>
                                </form>
                            </section>
                            <footer className="py-10 text-center border-t border-gray-50"><p className="text-[10px] text-gray-300 uppercase">© 2025 Money Blackbox. All rights reserved.</p></footer>
                        </div>
                    </main>
                </div>
            );
        };
        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
